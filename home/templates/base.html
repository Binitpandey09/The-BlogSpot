<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    {% load static %}

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <title>{% block title %}{% endblock %}</title>

    {% block external_css %}{% endblock %}

<style>
    /* Navbar + Global CSS */

    .nav-profile-img {
        width: 38px;
        height: 38px;
        border-radius: 50%;
        object-fit: cover;
        cursor: pointer;
        border: 2px solid #fff;
    }

    .offcanvas {
        width: 260px;
    }
    .menu-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 10px;
        cursor: pointer;
        border-radius: 6px;
    }
    .menu-item:hover {
        background: #f5f5f5;
    }
    .menu-icon {
        font-size: 18px;
    }

    /* âœ… Page-level CSS will now be inserted here correctly */
    {% block css %}{% endblock %}
</style>

</head>

  <body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-light bg-white border-bottom px-3 sticky-top">
      <div class="d-flex align-items-center gap-3">

        <!-- Sidebar Toggle -->
        <button class="btn btn-light border-0" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Brand -->
        <a class="navbar-brand fs-4" href="/">BlogSpot</a>

        <!-- Search -->
        <form method="POST" action="/search/" class="d-none d-md-flex ms-4 w-50">
          {% csrf_token %}
          <input type="search" class="form-control" name="searched" placeholder="Search">
        </form>

      </div>

      <div class="d-flex align-items-center gap-3">

        <!-- Write Button -->
        {% if user.is_authenticated %}
        <a href="/add_blogs/" class="btn btn-outline-dark">Write</a>
        {% endif %}

        <!-- Notification Bell -->
        <span class="btn btn-light border-0">
          <i class="bi bi-bell"></i>
        </span>

        <!-- Profile Dropdown -->
        {% if user.is_authenticated %}
        <div class="dropdown">
          <img src="{% if user.profile.image %}{{ user.profile.image.url }}{% else %}{% static 'img/default-avatar.png' %}{% endif %}"
               class="nav-profile-img dropdown-toggle"
               data-bs-toggle="dropdown">
          <ul class="dropdown-menu dropdown-menu-end">

            <li class="px-3 py-2">
              <strong>{{ user.get_full_name|default:user.username }}</strong><br>
              <small class="text-muted">{{ user.email }}</small>
            </li>
            <hr class="dropdown-divider">

            <li><a class="dropdown-item" href="/profile/">View Profile</a></li>
            <li><a class="dropdown-item" href="/add_blogs/">Write</a></li>
            <li><a class="dropdown-item" href="#">Settings</a></li>
            <li><a class="dropdown-item" href="#">Help</a></li>

            <hr class="dropdown-divider">
            <li><a class="dropdown-item text-danger" href="/logout/">Sign Out</a></li>

          </ul>
        </div>
        {% else %}
        <a href="/login/" class="btn btn-outline-dark">Login</a>
        <a href="/register/" class="btn btn-dark">Sign Up</a>
        {% endif %}

      </div>
    </nav>

    <!-- LEFT SIDEBAR -->
    <div class="offcanvas offcanvas-start" id="sidebarMenu">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Menu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>

      <div class="offcanvas-body">

        <div class="menu-item"><span class="menu-icon">ğŸ </span> Home</div>
        <div class="menu-item"><span class="menu-icon">ğŸ”–</span> Library</div>
        <div class="menu-item" onclick="window.location='/profile/'"><span class="menu-icon">ğŸ‘¤</span> Profile</div>
        <div class="menu-item"><span class="menu-icon">ğŸ“</span> Stories</div>
        <div class="menu-item"><span class="menu-icon">ğŸ“Š</span> Stats</div>
        <hr>

        <div class="menu-item"><span class="menu-icon">ğŸ‘¥</span> Following</div>
        <div class="menu-item"><span class="menu-icon">â•</span> Find Writers</div>

      </div>
    </div>

    {% block body %}{% endblock %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    {% block js %}{% endblock %}
  </body>
</html>
